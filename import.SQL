/*
Navicat Premium Data Transfer
Source Server		: localhost
Source Server Type	: SQL Server 2014
Source Database		: HW
File Encoding		: utf-8
*/

-- Score_to_GPA: e.g. A -> 4.0
IF object_id('Score_to_GPA','U') IS NOT NULL
DROP TABLE Score_to_GPA;
CREATE TABLE Score_to_GPA(
	Score CHAR(2) PRIMARY KEY,
	GPA REAL
);
INSERT INTO Score_to_GPA VALUES('A',4.0);
INSERT INTO Score_to_GPA VALUES('A-',3.7);
INSERT INTO Score_to_GPA VALUES('B+',3.3);
INSERT INTO Score_to_GPA VALUES('B',3.0);
INSERT INTO Score_to_GPA VALUES('B-',2.7);
INSERT INTO Score_to_GPA VALUES('C+',2.3);
INSERT INTO Score_to_GPA VALUES('C',2.0);
INSERT INTO Score_to_GPA VALUES('C-',1.7);
INSERT INTO Score_to_GPA VALUES('D',1.3);
INSERT INTO Score_to_GPA VALUES('D-',1.0);
INSERT INTO Score_to_GPA VALUES('F',0.0);
INSERT INTO Score_to_GPA VALUES('P',NULL);

-- School -> Department -> Major
IF object_id('SDM','U') IS NOT NULL
DROP TABLE SDM;
CREATE TABLE SDM(
	Major CHAR(4) PRIMARY KEY,
	Mname CHAR(20) NOT NULL
);
INSERT INTO SDM VALUES('MANA','信息管理与信息系统');
INSERT INTO SDM VALUES('INFO','电子信息科学与技术');
INSERT INTO SDM VALUES('PHIL','哲♂学');

-- Student&Teacher
IF object_id('Student','U') IS NOT NULL
DROP TABLE Student;
CREATE TABLE Student(
	Sno CHAR(11) PRIMARY KEY,
	Sname CHAR(10) NOT NULL,
	Spasswd CHAR(10) NOT NULL,
	Ssex CHAR(2) CHECK(Ssex IN('男','女')),
	Sbirth DATE,
	Sgrade INT NOT NULL,
	Stel CHAR(11),
	Major CHAR(4) NOT NULL,
	FOREIGN KEY(Major) REFERENCES SDM(Major)
);
INSERT INTO Student VALUES('13307130279','李仁杰','123456','男',NULL,2013,NULL,'INFO');
INSERT INTO Student VALUES('14300690040','王周玮','123456','女',NULL,2014,NULL,'MANA');
INSERT INTO Student VALUES('14300690080','赵心爽','123456','女',NULL,2014,NULL,'MANA');

IF object_id('Teacher','U') IS NOT NULL
DROP TABLE Teacher;
CREATE TABLE Teacher(
	Tno CHAR(5) PRIMARY KEY,
	Tname CHAR(10) NOT NULL,
	Tpasswd CHAR(10) NOT NULL,
	Tsex CHAR(2) CHECK(Tsex IN('男','女')),
	Tbirth DATE,
	Tstage CHAR(10),
	Ttel CHAR(11),
	Major CHAR(4) NOT NULL,
	FOREIGN KEY(Major) REFERENCES SDM(Major)
);
INSERT INTO Teacher VALUES('60011','张成洪','123456','男',NULL,'教授',NULL,'MANA');
INSERT INTO Teacher VALUES('21652','赵燕','123456','女',NULL,'高级实验师',NULL,'INFO');
INSERT INTO Teacher VALUES('30069','陆起涌','123456','男',NULL,'主任技师',NULL,'INFO');
INSERT INTO Teacher VALUES('04871','他得安','123456','男',NULL,'教授',NULL,'INFO');
INSERT INTO Teacher VALUES('50044','邵强进','123456','男',NULL,'教授',NULL,'PHIL');
INSERT INTO Teacher VALUES('60032','黄丽华','123456','女',NULL,'教授',NULL,'MANA');
INSERT INTO Teacher VALUES('60033','傅烨','123456','男',NULL,'副教授',NULL,'MANA');
INSERT INTO Teacher VALUES('35009','窦一凡','123456','男',NULL,'助理教授',NULL,'MANA');

-- Courses
IF object_id('Course','U') IS NOT NULL
DROP TABLE Course;
CREATE TABLE Course(
	Cno CHAR(10) NOT NULL,
	Cname CHAR(20) NOT NULL,
	Credit REAL NOT NULL,
	Cattribute CHAR(10) NOT NULL,
	Ctime CHAR(20),
	Cloc CHAR(20),
	Call INT NOT NULL,
	Cnow INT NOT NULL,
	Semester CHAR(6) NOT NULL,
	PRIMARY KEY(Cno,Semester)
);
INSERT INTO Course VALUES('MANA130355','数据库与数据挖掘',3,'必修','周二2-5','思源楼724',15,3,'2017-1');
INSERT INTO Course VALUES('INFO130015','生产实习',1,'必修',NULL,NULL,100,1,'2016-2');
INSERT INTO Course VALUES('INFO130013','近代无线电实验(下)',3,'必修','周二1-4','物理楼528',80,1,'2016-2');
INSERT INTO Course VALUES('INFO130077','计算机网络',2,'专业选修','周一6-7','4206',40,1,'2016-2');
INSERT INTO Course VALUES('INFO130012','近代无线电实验(上)',3,'必修','周一1-4','物理楼528',80,1,'2016-1');
INSERT INTO Course VALUES('INFO130232','电磁场与电磁波',3,'必修','周三3-5','4103',80,1,'2016-1');
INSERT INTO Course VALUES('PHIL119018','《逻辑哲学论》导读',2,'三模','周三11-12','HGX104',100,1,'2017-1');
INSERT INTO Course VALUES('PHIL119018','《逻辑哲学论》导读',2,'三模','周三11-12','HGX104',100,1,'2016-2');
INSERT INTO Course VALUES('MANA130007','管理信息系统',3,'必修','周二3-5','H6110',40,1,'2015-2');
INSERT INTO Course VALUES('MANA130078','电子商务',3,'专业选修','周四6-8','H6112',30,2,'2017-1');

-- Select Courses
IF object_id('SC','U') IS NOT NULL
DROP TABLE SC;
CREATE TABLE SC(
	Sno CHAR(11) NOT NULL,
	Cno CHAR(10) NOT NULL,
	Semester CHAR(6) NOT NULL,
	Score CHAR(2),
	FOREIGN KEY(Sno) REFERENCES Student(Sno),
	FOREIGN KEY(Cno,Semester) REFERENCES Course(Cno,Semester),
	FOREIGN KEY(Score) REFERENCES Score_to_GPA(Score),
	PRIMARY KEY(Sno,Cno,Semester)
);
INSERT INTO SC VALUES('13307130279','MANA130355','2017-1',NULL);
INSERT INTO SC VALUES('14300690040','MANA130355','2017-1',NULL);
INSERT INTO SC VALUES('14300690080','MANA130355','2017-1',NULL);
INSERT INTO SC VALUES('13307130279','INFO130015','2016-2','P');
INSERT INTO SC VALUES('13307130279','INFO130013','2016-2','A');
INSERT INTO SC VALUES('13307130279','INFO130077','2016-2','A');
INSERT INTO SC VALUES('13307130279','INFO130012','2016-1','A-');
INSERT INTO SC VALUES('13307130279','INFO130232','2016-1','B+');
INSERT INTO SC VALUES('14300690080','PHIL119018','2017-1',NULL);
INSERT INTO SC VALUES('14300690040','PHIL119018','2016-2','A-');
INSERT INTO SC VALUES('14300690040','MANA130007','2015-2','B+');
INSERT INTO SC VALUES('14300690080','MANA130078','2017-1',NULL);
INSERT INTO SC VALUES('14300690040','MANA130078','2017-1',NULL);

-- Elective Courses
IF object_id('EC','U') IS NOT NULL
DROP TABLE EC;
CREATE TABLE EC(
	Major CHAR(4) NOT NULL,
	Sgrade INT NOT NULL,
	Cattribute CHAR(10) NOT NULL,
	ReqCredit REAL NOT NULL,
	PRIMARY KEY(Major,Sgrade,Cattribute)
);
INSERT INTO EC VALUES('INFO',2013,'专业选修',14);
INSERT INTO EC VALUES('MANA',2014,'三模',2);
INSERT INTO EC VALUES('MANA',2014,'专业选修',12);

-- Required Courses
IF object_id('RC','U') IS NOT NULL
DROP TABLE RC;
CREATE TABLE RC(
	Major CHAR(4) NOT NULL,
	Sgrade INT NOT NULL,
	Cno CHAR(10) NOT NULL,
	PRIMARY KEY(Major,Sgrade,Cno)
);
INSERT INTO RC VALUES('MANA',2014,'MANA130355');
INSERT INTO RC VALUES('INFO',2013,'INFO130015');
INSERT INTO RC VALUES('INFO',2013,'INFO130013');
INSERT INTO RC VALUES('INFO',2013,'INFO130077');
INSERT INTO RC VALUES('INFO',2013,'INFO130012');
INSERT INTO RC VALUES('INFO',2013,'INFO130232');
INSERT INTO RC VALUES('MANA',2014,'MANA130007');
INSERT INTO RC VALUES('MANA',2014,'MANA130005');
INSERT INTO RC VALUES('MANA',2014,'MANA130042');

-- Book, Bno == ISBN
IF object_id('Book','U') IS NOT NULL
DROP TABLE Book;
CREATE TABLE Book(
	Bno CHAR(20) PRIMARY KEY,
	Bname CHAR(50) NOT NULL,
	Bauthor CHAR(20) NOT NULL,
	Bpublish CHAR(20) NOT NULL,
	Bvalue REAL NOT NULL
);
INSERT INTO Book VALUES('9787111165057','计算机网络自顶向下方法','（美）库罗斯','机械工业出版社',66.00);
INSERT INTO Book VALUES('9787040182583','电磁场与电磁波','谢处方、饶克谨','高等教育出版社',33.60);
INSERT INTO Book VALUES('9787040406641','数据库系统概论','王珊、萨师煊','高等教育出版社',39.60);
INSERT INTO Book VALUES('9787111515678','管理信息系统','黄丽华等译','机械工业出版社',59.00);

-- Teach Courses
IF object_id('TC','U') IS NOT NULL
DROP TABLE TC;
CREATE TABLE TC(
	Tno CHAR(5) NOT NULL,
	Cno CHAR(10) NOT NULL,
	Semester CHAR(6),
	Bno CHAR(20),
	FOREIGN KEY(Tno) REFERENCES Teacher(Tno),
	FOREIGN KEY(Cno,Semester) REFERENCES Course(Cno,Semester),
	FOREIGN KEY(Bno) REFERENCES Book(Bno),
	PRIMARY KEY(Tno,Cno,Semester)
);
INSERT INTO TC VALUES('60011','MANA130355','2017-1','9787040406641');
INSERT INTO TC VALUES('21652','INFO130015','2016-2',NULL);
INSERT INTO TC VALUES('30069','INFO130013','2016-2',NULL);
INSERT INTO TC VALUES('30069','INFO130012','2016-1',NULL);
INSERT INTO TC VALUES('30069','INFO130077','2016-2','9787111165057');
INSERT INTO TC VALUES('04871','INFO130232','2016-1','9787040182583');
INSERT INTO TC VALUES('50044','PHIL119018','2017-1',NULL);
INSERT INTO TC VALUES('50044','PHIL119018','2016-2',NULL);
INSERT INTO TC VALUES('60032','MANA130007','2015-2','9787111515678');
INSERT INTO TC VALUES('35009','MANA130078','2017-1',NULL);